---
date: 2026-02-15
tags:
  - journal/daily
---

# Journal: 2026-02-15

## Summary

Major project restructuring and database schema implementation completed.

## Completed Tasks

### 1. Project Structure Refactoring ✅

Reorganized documentation structure:
- Created epic-based folder structure (`01-epics/`)
- Deleted old flat `01-features/` structure
- Removed unused `project-specification.md` and root `_index.md`
- Created `00-meta/` for project roadmap and standards

### 2. Database Schema Implementation ✅

**Schema File**: `apps/web/server/db/schema.ts`

**Key Changes**:
- ✅ **Application-generated IDs** (removed all `defaultRandom()`)
- ✅ Added `company_id` to `user_group_members` for easy sync
- ✅ Removed `parent_id` from `folders` (hierarchy in workspace.menu JSONB)
- ✅ Generated new migration after fixes

**Tables**: 9 tables with Drizzle ORM

### 3. Database Seed Task ✅

**File**: `apps/web/server/tasks/seed.ts`

Nitro task for development seeding.

### 4. Shared Types ✅

**File**: `apps/web/shared/types/db.ts`

TypeScript types for frontend (auto-imported in Vue).

### 5. Test Plan Created ✅

**File**: `02-tests/test-foundation-002-db-schema-basic.md`

11 test scenarios covering:
- Application-generated IDs
- Schema validation
- Foreign key constraints
- Unique constraints
- Soft deletes
- Relations

### 6. AGENTS.md Updated ✅

Added comprehensive documentation:
- Epic-based workflow rules
- **⚠️ ID Generation Rule**: Never use `defaultRandom()`
- NuxtHub database guidelines
- Migration workflow

### 7. New Features Created ✅

Renumbered features in Foundation epic:

| # | Feature | Status |
|---|---------|--------|
| 001 | Project Setup | ✅ Finish |
| 002 | DB Schema - Basic | ✅ Finish |
| 003 | Electric SQL + PGlite | ⏳ Pending |
| 004 | Auth System | ⏳ Pending |

**003: Electric SQL + PGlite**
- Real-time sync setup
- Local-first architecture
- PGlite client database

**004: Auth System** 
- Uses `nuxt-auth-utils`
- OAuth (GitHub, Google)
- Password login
- Session management

## Feature Status Updates

| Feature | Status |
|---------|--------|
| 001-project-setup | ✅ Finish |
| 002-db-schema-basic | ✅ Finish |
| 003-electric-sql | ⏳ Pending |
| 004-auth-system | ⏳ Pending |

## Technology Choices

### Auth: nuxt-auth-utils ✅

Selected over alternatives because:
- 40+ OAuth providers built-in
- Session management with sealed cookies
- Password hashing (scrypt)
- Works with NuxtHub
- Official Nuxt community module

## Next Steps (For Tomorrow)

1. **003-electric-sql**: Setup Electric SQL + PGlite
2. **004-auth-system**: Implement auth with nuxt-auth-utils
   - Install package
   - Configure OAuth
   - Create login/register pages

## Notes

- All IDs are now application-generated (`crypto.randomUUID()`)
- Migration regenerated with new schema
- Test plan ready for 002-db-schema-basic
